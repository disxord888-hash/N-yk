# .11yk 圧縮ファイル形式仕様書 (v1.0)

## 1. 概要
`.11yk` は、ZIP 互換の圧縮ファイル形式である。実体は標準的な ZIP 構造を持つが、独自の厳格な制約を課すことにより、軽量データ専用のフォーマットとして定義される。

本フォーマットは、仕様違反時に **「破損扱い」** となることを前提に設計されている。

## 2. 基本仕様
| 項目 | 内容 |
| :--- | :--- |
| 拡張子 | **.11yk** |
| 実体形式 | ZIP |
| MIME（参考） | application/x-11yk+zip |
| 分類 | 圧縮ファイル形式 |
| 互換性 | ZIP 解凍ライブラリで展開可能 |

## 3. 内部構造
- ZIP 標準仕様に準拠する。
- 圧縮方式は ZIP がサポートする方式であれば問わない。
- ディレクトリ構造の有無は任意。
- ファイル名の文字コードは **UTF-8** を推奨。

## 4. サイズ制限（必須仕様）
### 4.1 単一ファイルサイズ制限
- **1ファイルあたり最大サイズ：1024KB（1,048,576 bytes）**
- この制限は **圧縮前のサイズ（展開後サイズ）** に適用される。

### 4.2 仕様違反時の扱い
以下の条件に該当した場合、当該 `.11yk` ファイルは **破損扱い** とする：
- 1ファイルでも 1024KB を超えるデータを含む。
- 制限超過ファイルがディレクトリ配下に存在する。

※ ZIP として解凍可能であっても、`.11yk` としては **無効（破損）** とする。

## 5. 検証ルール（実装基準）
`.11yk` ファイルを処理する実装は、必ず以下の検証を行わなければならない：
1. ZIP として展開可能であること。
2. 全エントリの展開後サイズを確認すること。
3. サイズ制限違反が存在しないこと。

## 6. エラー定義
| エラー名 | 内容 |
| :--- | :--- |
| `ERR_11YK_SIZE_EXCEEDED` | 単一ファイルが 1024KB を超過 |
| `ERR_11YK_INVALID_ZIP` | ZIP として不正 |
| `ERR_11YK_CORRUPTED` | .11yk 仕様違反により破損扱い |

## 7. 推奨実装ポリシー
- サイズ検証は **展開前メタデータ取得時点** で行う。
- 仕様違反を検出した時点で処理を中断する。
- 自動修復や分割処理は行わない。

## 8. 想定用途
- 小規模設定ファイル群
- 軽量データのパッケージング
- サイズ制限付き配布フォーマット
- 意図的に大容量データを排除する用途

## 9. 非対応事項
以下は `.11yk` 仕様の対象外とする：
- 暗号化 ZIP の必須対応
- マルチボリューム ZIP
- サイズ制限の自動回避
- 後方互換性保証

## 10. 仕様の思想
`.11yk` は **「軽さを保証する代わりに、制限を破った瞬間に壊れる」** という思想のもと設計された圧縮フォーマットである。

## 11. バージョン情報
| 項目 | 内容 |
| :--- | :--- |
| 仕様名 | .11yk Format Specification |
| バージョン | 1.0 |
| 状態 | Initial Release |
